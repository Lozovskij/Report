\chapter{Теория}\label{theory}

Задача оптимального управления для группы $q$ взаимосвязанных линейных нестационарных объектов управления имеет вид:
\begin{equation}\label{main_task}
\sum_{i \in I} c_i' x_i(t_f) \to \min_{u},
\end{equation}
\[
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i,
\]
\[
 x_i(t_0) = x_{i,0}, \ i\in I,
\]
\[ \sum_{i \in I} H_i x_i(t_f) \geqslant g, \]
\[u_i(t) \in U_i, \quad t\in T, \quad i \in I.\]

В \textit{децентрализованном} случае каждый объект управления имеет собственный регулятор. Этот локальный регулятор для каждого $i$-го объекта по точному состоянию $x_i^*(\tau), \ \tau \in T_h$, своего объекта и состояниям $x_j^*(\tau - h), \ \tau \in T_h, \ j \in I_i,$ остальных объектов в предыдущий момент времени строит локальное управляющее воздействие $u_i^*(t), \ t \in [\tau, \ \tau + h), \ \tau \in T_h$, которое используется до тех пор, пока не будет измерено и обработано следующее состояние $x_i^*(\tau + h)$.

Для определения управления, которое будет использоваться регулятором на первом шаге, будем считать, что имеется единый центр, который до начала процесса управления способен по априорной информации вычислить оптимальную программу.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Вспомогательная задача оптимального управления для $i$-го регулятора для момента $\tau$ аналогично \cite{JVM_2008_2} имеет вид:
\begin{equation}\label{controller_task}
\sum_{k \in I} c_k' x_k(t_f) \to \min_{u_i},
\end{equation}
\[
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i, \quad   x_i(\tau) = x^*_i(\tau)
\]
\[
\dot x_k = A_k(t) x_k + \sum_{j \in I_k} A_{kj}(t)x_j + f_k^0(t|\tau), \quad   x_k(\tau) = x^0_k(\tau|\tau - h), \quad  k \in I_i,
\]
\[ \sum_{k \in I} H_k x_k(t_f) \geqslant g(\tau), \quad u_i(t) \in U_i,\quad t\in T(\tau),\]
где
\[
f_k^0(t|\tau)=B_k(t)u_k^0(t|\tau-h), \quad t\in T(\tau), \tau \in T_h\backslash t_0, \quad k \in I_i;
\]
\[
g(\tau) = \sum_{k \in I} H_k x_k^0(t_f|\tau-h)+\left[{ g - \sum_{k \in I} H_k x_k^0(t_f|\tau-h)}\right]/q.
\]


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Алгоритм построения реализации оптимальной обратной связи $u_i^*(t), \ t \in T, \ i \in I$ для случая децентрализованного оптимального управления имеет вид:

\begin{enumerate}

\item Найти оптимальную программу $u^0(t), \ t \in T$, задачи (\ref{main_task}).

\item  Задать значение оптимальной обратной связи для позиции $(t_0,x^*(t_0))$:
\[
u^0(t_0, \ x^*(t_0)) = u^0(t_0),
\]
и подать на объект управления управляющее воздействие 
\[
    u_i^*(t) \equiv u_i^*(t_0) := u_i^0(t_0, \ x^*(t_0)), \  \ t\in [t_0, \  t_0+h).
\]

\item Измерить  $x_i^*(t_0 + h)$ и вычислить $x_k^0(t_0 + h), \ k\in I_i$.

\item Положить $\tau = t_0 + h, \ x_k(\tau) = x_k^0(\tau), \ k\in I_i, \  x_i(\tau) = x_i^*(\tau)$.

\item Найти оптимальную программу $u_i^0(t|\tau, \ x_i^*(\tau), \ x^*(\tau - h)), \ t\in [\tau, \ t_f],$ задачи (\ref{controller_task}).

\item  Задать значение оптимальной обратной связи для позиции $(\tau,x(\tau))$:
\[
u_i^0(\tau, x(\tau)) = u_i^0(\tau|\tau, \ x_i^*(\tau), \ x^*(\tau - h)),
\]
и подать на объект управления управляющее воздействие 
\[
    u_i^*(t) \equiv u_i^*(\tau) := u_i^0(\tau, x(\tau)), \ \ t\in [\tau, \ \tau+h).
\]

\item В момент $\tau + h$ измерить  $x_i^*(\tau + h)$ и вычислить  $x_k^0(\tau + h), \ k\in I_i$, положить $\tau:= \tau+ h$, при $\tau < t_f$ вернуться к шагу 5.
\end{enumerate}

Основная трудоемкость реализации данного алгоритма приходится на шаг 5, на котором необходимо быстро (за время, не превосходящее $h$) решать задачу оптимального управления (\ref{controller_task}).

Пусть $u^0(\tau|\tau, \ x^*(\tau), \ x^*(\tau - h)) = (u_i^0(\tau|\tau, \  x_i^*(\tau), \ x^*(\tau - h)), \ i\in I), \ t \in T(\tau)$ --- управляющее воздействие, составленное из оптимальных программ задач (\ref{controller_task}), $x(t|x^*(\tau),u^0(\cdot)), \ t \in T(\tau),$ --- порождаемая им траектория группы с начальными условиями $x_i(\tau) = x_i^*(\tau), \ i\in I$.

В качестве обоснования применимости указанной схемы и алгоритма для решения децентрализованной задачи (\ref{main_task}) используется утверждение(\cite{JVM_2008}, с. 599):
\begin{theorem}
Для любого $\tau \in T_h$ управляющее воздействие $u^0(t|\tau, \ x_i^*(\tau), \ x^*(\tau - h)), \ t \in T(\tau),$ переводит группу объектов управления из состояния $x^*(\tau)$ на терминальное множество, то есть $x(t_f|x^*(\tau),u^0(\cdot)) \in X_f.$
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Используя элементы функциональной формы \cite{JVM_2000}, задачу (\ref{controller_task}) можно представить в виде:

\[ 
\sum_{s \in T_h(\tau)} c_i'(s) u_i(s) \to \min, \quad
\]
\[
\sum_{s \in T_h(\tau)} D_i(s) u_i(s) \geqslant \tilde{g_i}(\tau), \quad
\]
\[
u_{i,*} \leqslant u_i(s) \leqslant u_i^*, \quad 
s \in T_h(\tau).
\]

Здесь $T_h(\tau) = T_h \cap [\tau,t_f];$

\[
c_i'(s) = \int \limits_{s}^{s+h} \psi_i'(t) B_i(t) d t, \quad
D_i(s) = \int \limits_{s}^{s+h} \Phi_i(t) B_i(t) d t, \quad
s \in T_h(\tau);
\]
\[
	\dot \psi_i' = - \psi_i' A_i(t) - \sum_{j \in I_i} \psi_j' A_{ji}(t),
	\quad
	\psi_i(t_f)=c_i, \quad 
	i \in I; \quad
\]
\[
	\tilde{g_i}(\tau)= -\left[{ g + \sum_{k \in I} g_k(\tau-h)}\right]/q + g_i(\tau-h) + \Phi_i(\tau) \left( {x_i^0(\tau|\tau-h)-x_i^*(\tau)} \right) -
\]
\[
- \Phi_i(\tau-h) x_i^*(\tau-h) - D_i(\tau-h) u _i^*(\tau-h),
\]
\[
\Phi_k(t) = \sum_{j \in I}H_j F_{jk}(t_f,t), \quad F_{jk}(t_f,t) = (E^{A(t_f-t)})_{jk}.
\]

